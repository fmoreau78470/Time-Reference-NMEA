{"config":{"lang":["en","fr"],"separator":"[\\s\\-]+","pipeline":["stopWordFilter"],"fields":{"title":{"boost":1000.0},"text":{"boost":1.0},"tags":{"boost":1000000.0}}},"docs":[{"location":"index.html","title":"Accueil - Time Reference NMEA","text":"<p>Bienvenue dans la documentation officielle du projet Time Reference NMEA.</p> <p>Ce projet a pour but de transformer un ordinateur standard sous Windows en un Serveur de Temps de haute pr\u00e9cision (Stratum 1), capable de discipliner son horloge interne avec une pr\u00e9cision de l'ordre de la milliseconde, sans d\u00e9pendre d'une connexion Internet.</p> <p>Il a \u00e9t\u00e9 sp\u00e9cifiquement cr\u00e9\u00e9 pour r\u00e9pondre aux besoins d'horodatage pr\u00e9cis d'acquisitions n\u00e9cessaires \u00e0 la r\u00e9alisation de courbes de lumi\u00e8re pour l'observation d'occultations, particuli\u00e8rement en situation de mobilit\u00e9 o\u00f9 aucune connexion Internet n'est disponible.</p>"},{"location":"index.html#pourquoi-ce-projet","title":"\ud83c\udfaf Pourquoi ce projet ?","text":"<p>Dans un monde connect\u00e9, l'heure est g\u00e9n\u00e9ralement fournie par des serveurs NTP sur Internet (Stratum 2 ou 3). Bien que suffisant pour un usage bureautique, ce syst\u00e8me pr\u00e9sente des limites :</p> <ul> <li>Latence r\u00e9seau variable : Le temps de trajet des paquets sur Internet fluctue (Jitter), d\u00e9gradant la pr\u00e9cision.</li> <li>D\u00e9pendance : Sans Internet, l'horloge d\u00e9rive rapidement.</li> <li>S\u00e9curit\u00e9 : D\u00e9pendance \u00e0 des tiers.</li> </ul> <p>Time Reference NMEA r\u00e9sout ces probl\u00e8mes en utilisant une source mat\u00e9rielle locale : un r\u00e9cepteur GPS/GNSS.</p>"},{"location":"index.html#les-avantages","title":"Les avantages","text":"<ul> <li>Pr\u00e9cision Stratum 1 : Votre PC est directement reli\u00e9 \u00e0 la source atomique des satellites GPS.</li> <li>Autonomie : Fonctionne parfaitement en mode \"Terrain\" (Offline).</li> <li>Stabilit\u00e9 : Utilisation du signal PPS (Pulse Per Second) pour une synchronisation ultra-pr\u00e9cise.</li> </ul>"},{"location":"index.html#fonctionnement-global","title":"\ud83d\ude80 Fonctionnement global","text":"<p>Le syst\u00e8me repose sur la synergie entre trois composants :</p> <ol> <li>Le Mat\u00e9riel (Hardware) : Un module GPS (type u-blox) coupl\u00e9 \u00e0 un microcontr\u00f4leur (RP2040) qui convertit les signaux satellites en un flux de donn\u00e9es compr\u00e9hensible par l'ordinateur via USB.</li> <li>Le Service NTP (Meinberg) : Le standard industriel pour la gestion du temps sous Windows. Il discipline l'horloge syst\u00e8me en arri\u00e8re-plan.</li> <li>L'Application de Contr\u00f4le (Ce logiciel) : Une interface graphique moderne pour :<ul> <li>Configurer le service NTP sans ligne de commande.</li> <li>Visualiser la r\u00e9ception GPS et la qualit\u00e9 du signal.</li> <li>Calibrer automatiquement les d\u00e9lais de transmission (Fudge).</li> <li>Surveiller la sant\u00e9 de votre serveur de temps.</li> </ul> </li> </ol>"},{"location":"index.html#les-grandes-etapes-de-mise-en-uvre","title":"\ud83d\udee0\ufe0f Les grandes \u00e9tapes de mise en \u0153uvre","text":"<ol> <li>Assemblage du Mat\u00e9riel : Connexion du module GPS au RP2040 et flashage du firmware \"Stratum 0\".</li> <li>Installation Logicielle : Installation du service NTP Meinberg et de l'application Time Reference NMEA.</li> <li>Calibration : Calcul de la latence (Fudge) pour aligner parfaitement l'heure GPS avec la r\u00e9alit\u00e9.</li> <li>Mise en Production : Le syst\u00e8me tourne en autonomie et maintient l'heure pr\u00e9cise.</li> </ol>"},{"location":"index.html#organisation-de-la-documentation","title":"\ud83d\udcda Organisation de la documentation","text":"<ul> <li>Th\u00e9orie NTP : Comprendre les concepts de base (Stratum, Jitter, Offset).</li> <li>Guide Mat\u00e9riel : Liste des composants et instructions d'assemblage.</li> <li>Manuel Logiciel : Installation, configuration et utilisation de l'application.</li> <li>FAQ &amp; D\u00e9pannage : Solutions aux probl\u00e8mes courants.</li> </ul>"},{"location":"index.html#soutenir-le-projet","title":"\u2764\ufe0f Soutenir le projet","text":"<p>Si ce projet vous est utile, vous pouvez m'offrir un caf\u00e9 pour soutenir son d\u00e9veloppement !</p> <p></p>"},{"location":"faq.html","title":"FAQ &amp; D\u00e9pannage","text":""},{"location":"faq.html#mon-gps-ne-fixe-pas-pas-de-led-clignotante","title":"Mon GPS ne fixe pas (Pas de LED clignotante)","text":"<ul> <li>Assurez-vous d'\u00eatre \u00e0 l'ext\u00e9rieur ou pr\u00e8s d'une fen\u00eatre.</li> <li>V\u00e9rifiez l'alimentation du module (la LED Power doit \u00eatre allum\u00e9e).</li> </ul>"},{"location":"faq.html#lapplication-indique-port-com-introuvable","title":"L'application indique \"Port COM introuvable\"","text":"<ul> <li>V\u00e9rifiez que le RP2040 est bien branch\u00e9.</li> <li>V\u00e9rifiez dans le Gestionnaire de P\u00e9riph\u00e9riques qu'il n'y a pas d'erreur de pilote.</li> </ul>"},{"location":"faq.html#pourquoi-faut-il-les-droits-administrateur","title":"Pourquoi faut-il les droits administrateur ?","text":"<p>L'application doit arr\u00eater et red\u00e9marrer le service Windows Time (W32Time) ou NTPD pour appliquer les corrections de pr\u00e9cision.</p>"},{"location":"faq.html#peut-on-utiliser-ntp-sans-le-gps","title":"Peut-on utiliser NTP sans le GPS ?","text":"<p>Oui. Le service NTP (Meinberg) est con\u00e7u pour g\u00e9rer plusieurs sources. *   Si le GPS est d\u00e9connect\u00e9, le service bascule automatiquement sur les serveurs Internet (Pool NTP) configur\u00e9s en repli. *   Vous perdez la pr\u00e9cision Stratum 1 (microseconde) pour revenir \u00e0 une pr\u00e9cision Stratum 2 (milliseconde), mais votre horloge reste disciplin\u00e9e et plus pr\u00e9cise que via le service Windows standard. *   L'application affichera simplement que la source GPS est absente, mais le service NTP continuera de tourner en arri\u00e8re-plan.</p>"},{"location":"logiciel.html","title":"Manuel Logiciel","text":"<p>Ce guide d\u00e9taille l'installation, la configuration et l'utilisation de l'application Time Reference NMEA.</p>"},{"location":"logiciel.html#1-installation-de-lapplication","title":"1. Installation de l'Application","text":"<ol> <li>Rendez-vous dans la section Releases du projet GitHub.</li> <li>T\u00e9l\u00e9chargez le dernier installateur : <code>TimeReferenceNMEA_Setup_vX.Y.Z.exe</code>.</li> <li>Lancez l'installation (des droits administrateur seront demand\u00e9s pour pouvoir g\u00e9rer le service NTP).</li> <li>Une ic\u00f4ne est cr\u00e9\u00e9e sur votre bureau.</li> </ol>"},{"location":"logiciel.html#2-interface-principale","title":"2. Interface Principale","text":"<p>L'interface est con\u00e7ue pour surveiller la pr\u00e9cision en un coup d'\u0153il. Elle se compose d'une zone d'affichage principale et d'une barre d'outils.</p> <p></p>"},{"location":"logiciel.html#a-zone-daffichage","title":"A. Zone d'Affichage","text":"<p>Cette zone regroupe les indicateurs de performance en temps r\u00e9el :</p> <ul> <li>Horloges : Compare l'heure syst\u00e8me (Windows) et l'heure GPS. Un bouton permet de basculer entre UTC et Heure Locale.</li> <li>Position : Latitude et Longitude.</li> <li>Statut : Message d'\u00e9tat (ex: \"Fix GPS OK\", \"Recherche de satellites...\").</li> <li>Sant\u00e9 (Score) : Un indicateur global de fiabilit\u00e9 (0-100%).<ul> <li>\ud83d\udfe2 Vert (&gt; 90%) : Syst\u00e8me stable.</li> <li>\ud83d\udfe0 Orange (50-90%) : Perturbations l\u00e9g\u00e8res.</li> <li>\ud83d\udd34 Rouge (&lt; 50%) : Probl\u00e8me critique.</li> </ul> </li> <li>M\u00e9triques NTP :<ul> <li>Offset : L'\u00e9cart r\u00e9siduel avec la r\u00e9f\u00e9rence (id\u00e9alement &lt; 2ms).</li> <li>Jitter : La stabilit\u00e9 du signal.</li> </ul> </li> <li>Etat du service NTP : Affiche l'\u00e9tat technique des serveurs NTP.</li> </ul>"},{"location":"logiciel.html#b-zone-des-boutons","title":"B. Zone des Boutons","text":"<p>La barre d'outils situ\u00e9e au bas de la fen\u00eatre permet d'acc\u00e9der aux fonctionnalit\u00e9s :</p> <ul> <li>\u2699\ufe0f Param\u00e8tres : Configuration du mat\u00e9riel et du service NTP.</li> <li>\ud83d\udcc4 Logs : Journal des \u00e9v\u00e9nements.</li> <li>\ud83d\udce1 Qualit\u00e9 Signal (IQT) : Analyseur de r\u00e9ception satellite (SNR, HDOP).</li> <li>\ud83c\udf10 Pairs : Affiche ou masque le d\u00e9tail des sources NTP.</li> <li>\ud83c\udfaf Etalonnage : Assistant pour compenser le d\u00e9lai mat\u00e9riel.</li> <li>\ud83d\udd3d Mode Mini : Bascule en mode widget transparent \"Toujours visible\".</li> <li>\ud83c\udfa8 Th\u00e8me : Change l'apparence (Clair, Sombre, Rouge/Nuit).</li> </ul>"},{"location":"logiciel.html#3-premier-demarrage","title":"3. Premier D\u00e9marrage","text":"<p>Au lancement, l'application v\u00e9rifie la pr\u00e9sence du service NTP.</p> <p>\u26a0\ufe0f Pr\u00e9requis Absolu : Service NTP</p> <p>Ce logiciel ne fonctionne PAS avec le service de temps Windows standard (W32Time).</p> <p>Pour atteindre une pr\u00e9cision de l'ordre de la milliseconde (Stratum 1), vous DEVEZ installer le service NTP officiel maintenu par Meinberg.</p> <ol> <li> <p>T\u00e9l\u00e9chargez l'installateur \"NTP for Windows\" sur le site officiel : https://www.meinbergglobal.com/english/sw/ntp.htm</p> <p>\u26a0\ufe0f Attention : L'installation doit \u00eatre effectu\u00e9e en mode administrateur (Clic droit &gt; Ex\u00e9cuter en tant qu'administrateur) pour que le service puisse s'enregistrer correctement.</p> </li> <li> <p>Durant l'installation, conservez les options par d\u00e9faut.</p> </li> <li>Une fois install\u00e9, le service \"Network Time Protocol Daemon\" sera actif sur votre machine.</li> </ol> <p>Pourquoi ? W32Time est con\u00e7u pour la synchronisation de domaine (Kerberos) avec une tol\u00e9rance de 5 minutes. Meinberg NTP utilise des algorithmes complexes pour discipliner l'horloge avec une pr\u00e9cision microseconde et g\u00e9rer les sources mat\u00e9rielles comme notre GPS.</p> <p>Si le service est install\u00e9 mais arr\u00eat\u00e9, l'application tentera de le d\u00e9marrer automatiquement.</p>"},{"location":"logiciel.html#4-premiere-configuration","title":"4. Premi\u00e8re Configuration","text":"<ol> <li> <p>Cliquez sur le bouton Param\u00e8tres (ic\u00f4ne d'engrenage).</p> <p></p> Champ Description Valeur recommand\u00e9e Port S\u00e9rie Le port COM virtuel du RP2040 (voir Gestionnaire de P\u00e9riph\u00e9riques). <code>COMx</code> Vitesse La vitesse de communication s\u00e9rie du module GPS. <code>9600</code> Serveur Le pool NTP Internet utilis\u00e9 pour l'\u00e9talonnage et le repli. <code>fr.pool.ntp.org</code> Trouver vos serveurs NTP Ouvre <code>ntppool.org</code> pour trouver les serveurs de votre r\u00e9gion. Copier la liste de serveurs qui correspond \u00e0 votre pays (sans le mot-cl\u00e9 \"server\") Chemin ntp.conf Le chemin complet vers le fichier de configuration du service NTP. <code>C:\\Program Files (x86)\\NTP\\etc\\ntp.conf</code> Compensation Le d\u00e9lai mat\u00e9riel \u00e0 compenser. Cette valeur est ajust\u00e9e automatiquement par l'assistant d\u00e9talonnage. <code>0.000</code> (Initialement) Toujours visible Maintient la fen\u00eatre au premier plan (Always on Top). - Opacit\u00e9 Ajuste la transparence de la fen\u00eatre. 100% </li> <li> <p>Cliquez sur Enregistrer.</p> <ul> <li>L'application va g\u00e9n\u00e9rer un fichier <code>ntp.conf</code> optimis\u00e9 pour votre mat\u00e9riel.</li> <li>Elle va red\u00e9marrer le service NTP pour appliquer les changements.</li> </ul> </li> </ol>"},{"location":"logiciel.html#4-etalonnage","title":"4. Etalonnage","text":"<p>La compensation est le d\u00e9lai de transmission mat\u00e9riel (c\u00e2ble USB, traitement s\u00e9rie). Il faut le compenser pour \u00eatre parfaitement \u00e0 l'heure. Cliquez sur Etalonnage pour lancer l'assistant.</p> <p>\u2139\ufe0f Quand \u00e9talonner ?</p> <p>Cette op\u00e9ration doit \u00eatre effectu\u00e9e une seule fois pour tout nouvel assemblage (PC - C\u00e2ble USB - GPS). La compensation est sauvegard\u00e9e.</p> <p>Il est pr\u00e9f\u00e9rable de faire l'\u00e9talonnage sur un r\u00e9seau stable de type Fibre plut\u00f4t que sur un r\u00e9seau mobile (3G/4G/5G).</p> <p>L'assistant compare votre GPS avec des serveurs de temps Internet (Stratum 1/2) pendant une p\u00e9riode donn\u00e9e.</p> <p>Choisissez une dur\u00e9e d'\u00e9talonnage (entre 1 min et 60 min). Plus la dur\u00e9e est longue, meilleure sera la pr\u00e9cision de l'\u00e9talonnage.</p> <p>Le graphique affiche en gras la m\u00e9diane des offset (en ms) calcul\u00e9e au fil de la mesure. Les lignes fines correspondent \u00e0 l'offset mesur\u00e9 de chaque source.</p> <p>L'assistant attend que le GPS soit stable (Reach = 377) et qu'au moins une source Internet soit stable (Reach = 377) pour commencer \u00e0 calculer la m\u00e9diane.     </p>"},{"location":"logiciel.html#algorithme-de-letalonnage","title":"Algorithme de l'\u00e9talonnage","text":"<ol> <li>Isolation (Mode Observation) :<ul> <li>Le pilote GPS est configur\u00e9 en mode <code>noselect</code> dans NTP.</li> <li>Il continue d'envoyer des donn\u00e9es pour analyse, mais ne discipline plus l'horloge locale.</li> </ul> </li> <li>R\u00e9f\u00e9rence Absolue :<ul> <li>Le service NTP est forc\u00e9 de se synchroniser uniquement sur les serveurs Internet (Stratum 2).</li> <li>L'horloge syst\u00e8me du PC s'aligne donc sur le temps UTC Internet.</li> </ul> </li> <li>\u00c9chantillonnage :<ul> <li>L'application mesure en continu l'\u00e9cart (<code>offset</code>) rapport\u00e9 par le pilote GPS par rapport \u00e0 cette horloge syst\u00e8me synchronis\u00e9e.</li> <li>Une s\u00e9rie de mesures est effectu\u00e9e pour lisser le \"bruit\" r\u00e9seau (Jitter).</li> </ul> </li> <li>Calcul et Application :<ul> <li>L'algorithme extrait la m\u00e9diane des \u00e9carts pour \u00e9liminer les valeurs aberrantes.</li> <li>Il calcule la correction n\u00e9cessaire pour aligner le GPS sur Internet et met \u00e0 jour le param\u00e8tre Compensation <code>time2</code> (fudge) dans <code>ntp.conf</code>.</li> <li>La valeur <code>Compensation</code> est sauvegard\u00e9e et visible dans les param\u00e8tres</li> </ul> </li> </ol>"},{"location":"logiciel.html#6-outils-avances","title":"6. Outils Avanc\u00e9s","text":"<ul> <li> <p>Sources NTP (Peers) : Affiche le d\u00e9tail des serveurs de temps configur\u00e9s (commande <code>ntpq -p</code>).</p> <p>Cette fen\u00eatre permet de diagnostiquer pourquoi NTP choisit ou rejette une source.</p> <p>La source GPS_NMEA(x) est votre r\u00e9cepteur GPS. x correspond au port COMx utilis\u00e9.</p> <p> </p> <p>Note : Pour fermer cette fen\u00eatre, double-cliquez dessus.</p> <p>L\u00e9gende des symboles: *   <code>*</code> (Ast\u00e9risque) : La source actuelle de synchronisation (System Peer). *   <code>+</code> (Plus) : Source candidate de bonne qualit\u00e9, pr\u00eate \u00e0 prendre le relais. *   <code>-</code> (Moins) : Source \u00e9cart\u00e9e par l'algorithme de s\u00e9lection (Outlier). *   <code>x</code> (Croix) : Source rejet\u00e9e (Faux ticker, trop d'\u00e9cart ou inaccessible).</p> <p>Colonnes principales : *   remote : Adresse du serveur ou du pilote (ex: <code>127.127.20.x</code> pour le GPS). *   refid : La source de r\u00e9f\u00e9rence de ce serveur (ex: <code>.GPS.</code>, <code>.PPS.</code>). *   st : Stratum (Distance par rapport \u00e0 la source atomique). *   reach : Registre de disponibilit\u00e9 (377 = 100% de succ\u00e8s sur les 8 derniers essais). *   offset : L'\u00e9cart temporel en millisecondes. *   jitter : La stabilit\u00e9 du signal en millisecondes.</p> </li> <li> <p>Qualit\u00e9 Signal : Analyse la puissance (SNR) et la g\u00e9om\u00e9trie (HDOP) des satellites.</p> <ul> <li>Note : Cette fonction n\u00e9cessite l'arr\u00eat temporaire de NTP pour acc\u00e9der directement au port s\u00e9rie.</li> </ul> <p>Cette fen\u00eatre permet de diagnostiquer la qualit\u00e9 de votre installation d'antenne.</p> <p></p> <p>D\u00e9tail des indicateurs :</p> <ul> <li> <p>SCORE: Indice de Qualit\u00e9 du Signal (0 \u00e0 100%).     C'est une note globale pond\u00e9r\u00e9e calcul\u00e9e \u00e0 partir des trois param\u00e8tres ci-dessous.</p> <ul> <li>100% : R\u00e9ception optimale.</li> <li>&lt; 50% : R\u00e9ception d\u00e9grad\u00e9e, risque de perte de synchronisation.</li> </ul> </li> <li> <p>SNR (Signal Noise Ratio) : Rapport Signal/Bruit moyen (en dB).</p> <ul> <li>&gt; 30 dB (Vert) : Signal fort et clair.</li> <li>20 - 30 dB (Orange) : Signal moyen.</li> <li>&lt; 20 dB (Rouge) : Signal faible, risque de d\u00e9crochage.</li> </ul> </li> <li> <p>HDOP (Horizontal Dilution of Precision) : Pr\u00e9cision g\u00e9om\u00e9trique.</p> <ul> <li>Indique la dispersion des satellites dans le ciel. Plus la valeur est basse, meilleure est la pr\u00e9cision.</li> <li>&lt; 2.0 (Vert) : Id\u00e9al.</li> <li>2.0 - 5.0 (Orange) : Acceptable.</li> <li>&gt; 5.0 (Rouge) : Mauvais (Ciel obstru\u00e9, canyon urbain).</li> </ul> </li> <li> <p>SATS : Nombre de satellites utilis\u00e9s.</p> <ul> <li>&gt; 8 (Vert) : Confortable.</li> <li>4 - 8 (Orange) : Minimum vital.</li> <li>&lt; 4 (Rouge) : Insuffisant pour une triangulation fiable.</li> </ul> </li> </ul> </li> <li> <p>Logs : Historique des \u00e9v\u00e9nements pour le d\u00e9pannage.</p> </li> </ul>"},{"location":"logiciel.html#7-mode-mini-widget","title":"7. Mode Mini (Widget)","text":"<p>Pour surveiller votre serveur de temps sans encombrer l'\u00e9cran : 1.  Cliquez sur le bouton Mode Mini ou double-cliquer sur l'afficheur 2.  L'application devient une petite fen\u00eatre transparente qui reste au premier plan (\"Always on top\"). 3.  Double-cliquez dessus pour revenir au mode normal.</p> <pre><code>![Ma photo](../PrintScreen/Fenetre_mini.png)\n</code></pre>"},{"location":"materiel.html","title":"Guide Mat\u00e9riel &amp; Assemblage","text":"<p>Ce guide d\u00e9taille les composants n\u00e9cessaires et les \u00e9tapes d'assemblage pour construire votre r\u00e9cepteur GPS Stratum 0.</p>"},{"location":"materiel.html#1-approvisionnement-des-composants","title":"1. Approvisionnement des Composants","text":"<p>Le projet est con\u00e7u pour \u00eatre accessible et peu co\u00fbteux. Voici la liste des composants recommand\u00e9s :</p> Composant Mod\u00e8le Recommand\u00e9 R\u00f4le Microcontr\u00f4leur Waveshare RP2040-Zero Interface USB et traitement du signal. Choisi pour sa taille compacte et sa compatibilit\u00e9 Arduino. Module GPS u-blox NEO-6M ou NEO-8M R\u00e9ception satellite. Souvent vendu sous la r\u00e9f\u00e9rence <code>GY-GPS6MV2</code> ou <code>GY-NEO6MV2</code>. C\u00e2ble USB USB Type-C (Data) Liaison vers le PC. Assurez-vous qu'il transmet bien les donn\u00e9es (pas seulement la charge)."},{"location":"materiel.html#2-cablage-inter-modules","title":"2. C\u00e2blage Inter-modules","text":"<p>Le montage relie le module GPS au microcontr\u00f4leur via une liaison s\u00e9rie (UART). </p>"},{"location":"materiel.html#schema-de-connexion","title":"Sch\u00e9ma de connexion","text":"Pin GPS Pin RP2040-Zero Description VCC 5V (ou VBUS) Alimentation du module GPS. GND GND Masse commune (R\u00e9f\u00e9rence \u00e9lectrique). TX GP1 (RX) Transmission des donn\u00e9es NMEA du GPS vers le RP2040. RX GP0 (TX) R\u00e9ception des commandes de configuration . PPS GP2 Signal PPS (Pulse per Second) ."},{"location":"materiel.html#3-cablage-du-signal-pps","title":"3. C\u00e2blage du Signal PPS","text":"<p>C'est la connexion la plus critique pour la pr\u00e9cision temporelle de ce projet.</p> <p>Tous les modules GPS ne disposent pas de broche PPS.</p> <p>C'est le cas du NEO-6M (voir photo). Dans ce cas, il faut se connecter \u00e0 la sortie du circuit qui alimente la led. C'est le fil orange.</p> <p>Le NEO-8M dispose d'une broche appel\u00e9e PPS.</p> <ul> <li>Destination : Pin GP2 du RP2040-Zero.</li> </ul> <p></p> <p>Pourquoi est-ce indispensable ? Les donn\u00e9es NMEA (envoy\u00e9es via TX/RX) fournissent la date et l'heure, mais avec une latence variable (Jitter) de plusieurs centaines de millisecondes due au traitement s\u00e9rie.</p> <p>Le signal PPS (Pulse Per Second) est une impulsion \u00e9lectrique envoy\u00e9e physiquement au d\u00e9but exact de chaque seconde atomique. Le RP2040 utilise ce signal pour aligner l'envoi des donn\u00e9es au PC avec une pr\u00e9cision microseconde.</p>"},{"location":"materiel.html#indicateur-visuel-led-pps","title":"Indicateur Visuel (LED PPS)","text":"<p>La plupart des modules GPS (u-blox NEO-6M/8M) poss\u00e8dent une petite LED int\u00e9gr\u00e9e reli\u00e9e au signal PPS.</p> <ul> <li>Comportement : Elle reste \u00e9teinte (ou fixe selon le mod\u00e8le) tant que le GPS cherche les satellites. Elle se met \u00e0 clignoter d\u00e8s que le \"Fix\" est acquis (3D Fix).</li> <li>Caract\u00e9ristiques du signal : C'est le front montant (le d\u00e9but de l'allumage) qui marque la seconde pr\u00e9cise. <p>Note : L'impulsion \u00e9lectrique dure exactement 100 ms.</p> </li> </ul>"},{"location":"materiel.html#4-positionnement-et-perturbations","title":"4. Positionnement et Perturbations","text":"<p>Les signaux GPS/GNSS sont des ondes radio extr\u00eamement faibles (-125 dBm \u00e0 -160 dBm). L'environnement physique du montage impacte directement la qualit\u00e9 de r\u00e9ception (SNR).</p>"},{"location":"materiel.html#eviter-les-interferences","title":"\u00c9viter les interf\u00e9rences","text":"<p>L'\u00e9lectronique num\u00e9rique rapide (le processeur du RP2040, le port USB, le PC) g\u00e9n\u00e8re du \"bruit\" radiofr\u00e9quence qui peut brouiller l'antenne GPS.</p> <ul> <li>Distance : Ne collez pas l'antenne GPS directement sur le RP2040. Laissez au moins 5 \u00e0 10 cm de c\u00e2ble entre les deux.</li> <li>Bo\u00eetier : Si vous utilisez un bo\u00eetier m\u00e9tallique, l'antenne doit imp\u00e9rativement \u00eatre \u00e0 l'ext\u00e9rieur.</li> </ul>"},{"location":"materiel.html#orientation-de-lantenne","title":"Orientation de l'antenne","text":"<ul> <li>L'antenne c\u00e9ramique (le carr\u00e9 plat) doit avoir une vue d\u00e9gag\u00e9e vers le ciel.</li> <li>Elle fonctionne \u00e0 travers le plastique, le verre ou le bois, mais pas \u00e0 travers le m\u00e9tal ou la fibre de carbone.</li> <li>Pour une utilisation en int\u00e9rieur (proche d'une fen\u00eatre), la pr\u00e9cision sera moindre (Stratum 1 d\u00e9grad\u00e9) par rapport \u00e0 une antenne ext\u00e9rieure active.</li> </ul>"},{"location":"materiel.html#5-installation-du-firmware-stratum-0","title":"5. Installation du Firmware (Stratum 0)","text":"<p>Une fois le mat\u00e9riel assembl\u00e9, vous devez flasher le RP2040 pour qu'il agisse comme une interface intelligente.</p> <ol> <li>T\u00e9l\u00e9chargez le fichier <code>Stratum0.uf2</code> depuis la section Releases du projet GitHub.</li> <li>D\u00e9branchez le RP2040 du PC.</li> <li>Maintenez le bouton BOOT du RP2040 enfonc\u00e9 et branchez-le au PC.</li> <li>Un disque <code>RPI-RP2</code> appara\u00eet dans l'explorateur de fichiers.</li> <li>Copiez le fichier <code>Stratum0.uf2</code> dans ce disque.</li> <li>Le RP2040 red\u00e9marre automatiquement : votre mat\u00e9riel est pr\u00eat.</li> </ol>"},{"location":"materiel.html#led-de-diagnostic-rp2040-zero","title":"\ud83d\udca1 LED de Diagnostic (RP2040-Zero)","text":"<p>La LED RGB interne indique l'\u00e9tat du GPS : * Bleu : Aucune donn\u00e9e re\u00e7ue du GPS (v\u00e9rifier le c\u00e2blage). * Rouge : Donn\u00e9es GPS re\u00e7ues, mais pas de fix satellite. * Vert : Fix GPS acquis, mais signal PPS absent (&gt; 5s). * Flash Blanc : Signal PPS d\u00e9tect\u00e9 (La LED s'\u00e9teint entre les flashs quand le PPS est actif).</p> <p>Vous pouvez v\u00e9rifier que votre GPS \u00e9met les trames NMEA gr\u00e2ce \u00e0 l'analyse du port s\u00e9rie \u00e0 l'aide d'un logiciel de type Putty</p> <p></p>"},{"location":"materiel.html#6-fonctionnement-du-firmware-pour-aller-plus-loin","title":"6. Fonctionnement du Firmware (Pour aller plus loin)","text":"<p>Le code du RP2040 ne se contente pas de relayer les donn\u00e9es. Il transforme le module GPS grand public en une horloge de r\u00e9f\u00e9rence scientifique.</p>"},{"location":"materiel.html#le-defi-technique","title":"Le d\u00e9fi technique","text":"<p>Un module GPS \u00e9met deux informations :</p> <ol> <li>Le signal PPS : Une impulsion \u00e9lectrique ultra-pr\u00e9cise au d\u00e9but de la seconde.</li> <li>La trame NMEA : Un message texte (\"Il est 12h00m00s\") envoy\u00e9 via le port s\u00e9rie.</li> </ol> <p>Le probl\u00e8me est que le message texte arrive apr\u00e8s l'impulsion (environ 100 \u00e0 500ms plus tard). Si l'ordinateur attend le message pour se caler sur le prochain PPS, il sera en retard d'une seconde.</p>"},{"location":"materiel.html#la-solution-logicielle","title":"La solution logicielle","text":"<p>Le firmware utilise un algorithme de \"Time Adder\" :</p> <ol> <li>Il lit la trame NMEA d\u00e8s qu'elle arrive.</li> <li>Il ajoute 1 seconde \u00e0 l'heure re\u00e7ue (gestion des changements de minute, heure, jour, ann\u00e9e incluse).</li> <li>Il stocke cette trame \"futuriste\" en m\u00e9moire.</li> <li>Il attend le prochain signal PPS.</li> <li>D\u00e8s que le PPS claque, il envoie imm\u00e9diatement la trame modifi\u00e9e via USB.</li> </ol> <p>R\u00e9sultat : Windows re\u00e7oit l'heure \"12:00:01\" \u00e0 la microseconde exacte o\u00f9 la seconde 12:00:01 commence.</p>"},{"location":"theorie.html","title":"Th\u00e9orie NTP &amp; Synchronisation","text":"<p>Comprendre les m\u00e9canismes qui permettent \u00e0 votre ordinateur d'\u00eatre \u00e0 l'heure pr\u00e9cise est essentiel pour tirer le meilleur parti de ce projet. Cette page vulgarise les concepts cl\u00e9s du protocole NTP et explique pourquoi l'ajout d'un GPS change la donne.</p>"},{"location":"theorie.html#1-quest-ce-que-ntp","title":"1. Qu'est-ce que NTP ?","text":"<p>NTP (Network Time Protocol) est l'un des plus vieux protocoles d'Internet. Son r\u00f4le est de synchroniser l'horloge des ordinateurs \u00e0 travers un r\u00e9seau \u00e0 latence variable.</p> <p>Il fonctionne sur un mod\u00e8le hi\u00e9rarchique organis\u00e9 en Strates (Stratum) :</p> <ul> <li>Stratum 0 : La source de temps physique (Horloge Atomique, GPS). Elle ne se connecte pas au r\u00e9seau.</li> <li>Stratum 1 : Un ordinateur directement reli\u00e9 \u00e0 une source Stratum 0 (par c\u00e2ble s\u00e9rie/USB). C'est le \"Serveur de Temps Primaire\". C'est le r\u00f4le de votre PC avec ce projet.</li> <li>Stratum 2 : Un ordinateur qui demande l'heure \u00e0 un serveur Stratum 1 via Internet.</li> <li>Stratum 3 : Un ordinateur qui demande l'heure \u00e0 un Stratum 2, et ainsi de suite...</li> </ul> <p>Plus le num\u00e9ro de strate est \u00e9lev\u00e9, plus la pr\u00e9cision se d\u00e9grade \u00e0 cause des d\u00e9lais de transmission.</p>"},{"location":"theorie.html#2-pourquoi-le-gps-est-il-superieur-a-internet","title":"2. Pourquoi le GPS est-il sup\u00e9rieur \u00e0 Internet ?","text":"<p>La plupart des PC se synchronisent sur Internet (Stratum 2 ou 3). Bien que suffisant pour la vie quotidienne, ce syst\u00e8me souffre de d\u00e9fauts majeurs pour l'astronomie ou la science :</p>"},{"location":"theorie.html#a-la-latence-variable-jitter","title":"A. La Latence Variable (Jitter)","text":"<p>Sur Internet, les paquets de donn\u00e9es voyagent par des chemins diff\u00e9rents et traversent des routeurs encombr\u00e9s. Le temps de trajet \"aller\" n'est jamais exactement le m\u00eame que le temps \"retour\". Cette variation impr\u00e9visible s'appelle le Jitter (Gigue). *   Internet : Jitter typique de 10 \u00e0 100 ms. *   GPS Local : Jitter quasi-nul (&lt; 0.005 ms) car la liaison est directe (c\u00e2ble USB/S\u00e9rie).</p>"},{"location":"theorie.html#b-lasymetrie","title":"B. L'Asym\u00e9trie","text":"<p>NTP suppose th\u00e9oriquement que le temps de trajet Aller est \u00e9gal au temps de trajet Retour. Or, sur une connexion ADSL, 4G ou Fibre grand public, les d\u00e9bits descendants et montants sont diff\u00e9rents, cr\u00e9ant une erreur de calcul syst\u00e9matique (Offset) impossible \u00e0 corriger logiciellement.</p>"},{"location":"theorie.html#c-la-disponibilite","title":"C. La Disponibilit\u00e9","text":"<p>Sans Internet, l'horloge de votre PC d\u00e9rive rapidement (plusieurs secondes par jour). Le GPS fonctionne partout sur Terre, sans abonnement et sans r\u00e9seau, garantissant une autonomie totale (mode \"Terrain\").</p>"},{"location":"theorie.html#3-pourquoi-utiliser-meinberg-ntp","title":"3. Pourquoi utiliser Meinberg NTP ?","text":"<p>Windows int\u00e8gre par d\u00e9faut un service de temps appel\u00e9 W32Time. Pourquoi le remplacer ?</p> <ul> <li>W32Time a \u00e9t\u00e9 con\u00e7u pour l'authentification r\u00e9seau (Kerberos), qui tol\u00e8re jusqu'\u00e0 5 minutes d'erreur. Il n'est pas con\u00e7u pour la haute pr\u00e9cision scientifique. Il corrige souvent l'heure par \"sauts\" brutaux.</li> <li>Meinberg NTP est le portage sous Windows du d\u00e9mon NTP officiel (celui utilis\u00e9 par les serveurs Linux de la NASA ou du CERN).<ul> <li>Il discipline l'horloge en douceur (acc\u00e9l\u00e8re/ralentit la fr\u00e9quence) sans sauts temporels.</li> <li>Il atteint une pr\u00e9cision de l'ordre de la microseconde.</li> <li>Il offre des outils de diagnostic avanc\u00e9s (<code>ntpq</code>) que ce logiciel utilise.</li> </ul> </li> </ul>"},{"location":"theorie.html#4-les-algorithmes-de-ntp","title":"4. Les Algorithmes de NTP","text":"<p>NTP n'est pas une simple \"mise \u00e0 l'heure\". C'est un syst\u00e8me complexe d'asservissement.</p>"},{"location":"theorie.html#lalgorithme-dintersection-marzullo","title":"L'Algorithme d'Intersection (Marzullo)","text":"<p>Si vous configurez plusieurs sources (ex: GPS + 3 serveurs Internet), NTP doit deviner qui dit la v\u00e9rit\u00e9. Il compare les intervalles de temps de chaque source et rejette les \"menteurs\" (False Tickers) qui s'\u00e9loignent trop du consensus. C'est ce qui permet d'ignorer un serveur Internet d\u00e9faillant.</p>"},{"location":"theorie.html#la-boucle-de-discipline-pllfll","title":"La Boucle de Discipline (PLL/FLL)","text":"<p>Une fois la meilleure source choisie, NTP ne se contente pas de \"reset\" l'heure. Il calcule la d\u00e9rive naturelle de votre quartz (Drift). *   Si votre PC retarde de 10ms, NTP va augmenter l\u00e9g\u00e8rement la fr\u00e9quence de l'horloge pour rattraper le retard progressivement. *   Cela garantit une \u00e9chelle de temps continue et monotone (pas de retour en arri\u00e8re possible), indispensable pour l'enregistrement de donn\u00e9es (Logs, Bases de donn\u00e9es, Courbes de lumi\u00e8re).</p>"},{"location":"theorie.html#5-glossaire-des-termes-usuels","title":"5. Glossaire des Termes Usuels","text":"<p>Voici les termes techniques que vous rencontrerez dans l'application :</p> Terme D\u00e9finition Unit\u00e9 Bonnes valeurs Offset L'\u00e9cart temporel entre votre PC et la r\u00e9f\u00e9rence absolue. C'est l'erreur \u00e0 corriger. ms Proche de 0 (ex: +/- 2ms) Jitter La stabilit\u00e9 du signal (variance de la latence). Une valeur faible indique une connexion fiable. ms &lt; 5 ms (GPS) Drift La d\u00e9rive naturelle de l'horloge mat\u00e9rielle de votre PC (impr\u00e9cision du quartz). ppm Stable (ex: 15.000 ppm) Reach Registre (octal) indiquant le succ\u00e8s des 8 derni\u00e8res tentatives de connexion. C'est l'historique de sant\u00e9. - 377 (100% de succ\u00e8s) Poll Intervalle entre deux interrogations de la source (puissance de 2). s 16s (Poll 4) \u00e0 1024s (Poll 10) PPS Pulse Per Second. Signal \u00e9lectrique envoy\u00e9 par le GPS \u00e0 chaque d\u00e9but de seconde pr\u00e9cise. C'est le \"top\" ultime de synchronisation. - -"},{"location":"en/index.html","title":"Home - Time Reference NMEA","text":"<p>Welcome to the official documentation of the Time Reference NMEA project.</p> <p>This project aims to transform a standard Windows computer into a High Precision Time Server (Stratum 1), capable of disciplining its internal clock with millisecond precision, without relying on an Internet connection.</p> <p>It was specifically created to meet the needs of precise timestamping of acquisitions necessary for the realization of light curves for the observation of occultations, particularly in mobile situations where no Internet connection is available.</p>"},{"location":"en/index.html#why-this-project","title":"\ud83c\udfaf Why this project?","text":"<p>In a connected world, time is generally provided by NTP servers on the Internet (Stratum 2 or 3). Although sufficient for office use, this system has limitations:</p> <ul> <li>Variable network latency: Packet travel time on the Internet fluctuates (Jitter), degrading precision.</li> <li>Dependency: Without Internet, the clock drifts quickly.</li> <li>Security: Dependence on third parties.</li> </ul> <p>Time Reference NMEA solves these problems by using a local hardware source: a GPS/GNSS receiver.</p>"},{"location":"en/index.html#the-advantages","title":"The advantages","text":"<ul> <li>Stratum 1 Precision: Your PC is directly connected to the atomic source of GPS satellites.</li> <li>Autonomy: Works perfectly in \"Field\" mode (Offline).</li> <li>Stability: Uses the PPS (Pulse Per Second) signal for ultra-precise synchronization.</li> </ul>"},{"location":"en/index.html#global-operation","title":"\ud83d\ude80 Global Operation","text":"<p>The system relies on the synergy between three components:</p> <ol> <li>The Hardware: A GPS module (u-blox type) coupled with a microcontroller (RP2040) which converts satellite signals into a data stream understandable by the computer via USB.</li> <li>The NTP Service (Meinberg): The industry standard for time management under Windows. It disciplines the system clock in the background.</li> <li>The Control Application (This software): A modern graphical interface to:<ul> <li>Configure the NTP service without command line.</li> <li>Visualize GPS reception and signal quality.</li> <li>Automatically calibrate transmission delays (Fudge).</li> <li>Monitor the health of your time server.</li> </ul> </li> </ol>"},{"location":"en/index.html#major-implementation-steps","title":"\ud83d\udee0\ufe0f Major Implementation Steps","text":"<ol> <li>Hardware Assembly: Connection of the GPS module to the RP2040 and flashing of the \"Stratum 0\" firmware.</li> <li>Software Installation: Installation of the Meinberg NTP service and the Time Reference NMEA application.</li> <li>Calibration: Calculation of latency (Fudge) to perfectly align GPS time with reality.</li> <li>Production: The system runs autonomously and maintains precise time.</li> </ol>"},{"location":"en/index.html#documentation-organization","title":"\ud83d\udcda Documentation Organization","text":"<ul> <li>NTP Theory: Understanding basic concepts (Stratum, Jitter, Offset).</li> <li>Hardware Guide: Component list and assembly instructions.</li> <li>Software Manual: Installation, configuration, and use of the application.</li> <li>FAQ &amp; Troubleshooting: Solutions to common problems.</li> </ul>"},{"location":"en/index.html#support-the-project","title":"\u2764\ufe0f Support the project","text":"<p>If this project is useful to you, you can buy me a coffee to support its development!</p> <p></p>"},{"location":"en/faq.html","title":"FAQ &amp; Troubleshooting","text":""},{"location":"en/faq.html#my-gps-does-not-fix-no-flashing-led","title":"My GPS does not fix (No flashing LED)","text":"<ul> <li>Ensure you are outdoors or near a window.</li> <li>Check the module power supply (the Power LED must be on).</li> </ul>"},{"location":"en/faq.html#the-application-says-com-port-not-found","title":"The application says \"COM Port not found\"","text":"<ul> <li>Check that the RP2040 is properly connected.</li> <li>Check in Device Manager for any driver errors.</li> </ul>"},{"location":"en/faq.html#why-are-administrator-rights-required","title":"Why are administrator rights required?","text":"<p>The application must stop and restart the Windows Time service (W32Time) or NTPD to apply precision corrections.</p>"},{"location":"en/faq.html#can-ntp-be-used-without-gps","title":"Can NTP be used without GPS?","text":"<p>Yes. The NTP service (Meinberg) is designed to handle multiple sources. *   If the GPS is disconnected, the service automatically switches to the configured Internet servers (NTP Pool) as a fallback. *   You lose Stratum 1 precision (microsecond) to return to Stratum 2 precision (millisecond), but your clock remains disciplined and more accurate than via the standard Windows service. *   The application will simply display that the GPS source is missing, but the NTP service will continue running in the background.</p>"},{"location":"en/logiciel.html","title":"Software Manual","text":"<p>This guide details the installation, configuration, and use of the Time Reference NMEA application.</p>"},{"location":"en/logiciel.html#1-application-installation","title":"1. Application Installation","text":"<ol> <li>Go to the Releases section of the GitHub project.</li> <li>Download the latest installer: <code>TimeReferenceNMEA_Setup_vX.Y.Z.exe</code>.</li> <li>Run the installation (administrator rights will be requested to manage the NTP service).</li> <li>An icon is created on your desktop.</li> </ol>"},{"location":"en/logiciel.html#2-main-interface","title":"2. Main Interface","text":"<p>The interface is designed to monitor precision at a glance. It consists of a main display area and a toolbar.</p> <p></p>"},{"location":"en/logiciel.html#a-display-area","title":"A. Display Area","text":"<p>This area groups real-time performance indicators:</p> <ul> <li>Clocks: Compares system time (Windows) and GPS time. A button allows switching between UTC and Local Time.</li> <li>Position: Latitude and Longitude.</li> <li>Status: Status message (e.g., \"Fix GPS OK\", \"Searching for satellites...\").</li> <li>Health (Score): A global reliability indicator (0-100%).<ul> <li>\ud83d\udfe2 Green (&gt; 90%): Stable system.</li> <li>\ud83d\udfe0 Orange (50-90%): Slight disturbances.</li> <li>\ud83d\udd34 Red (&lt; 50%): Critical problem.</li> </ul> </li> <li>NTP Metrics:<ul> <li>Offset: The residual deviation from the reference (ideally &lt; 2ms).</li> <li>Jitter: Signal stability.</li> </ul> </li> <li>NTP Service Status: Displays the technical status of NTP servers.</li> </ul>"},{"location":"en/logiciel.html#b-button-area","title":"B. Button Area","text":"<p>The toolbar located at the bottom of the window provides access to features:</p> <ul> <li>\u2699\ufe0f Settings: Hardware and NTP service configuration.</li> <li>\ud83d\udcc4 Logs: Event log.</li> <li>\ud83d\udce1 Signal Quality (IQT): Satellite reception analyzer (SNR, HDOP).</li> <li>\ud83c\udf10 Peers: Shows or hides NTP source details.</li> <li>\ud83c\udfaf Calibration: Assistant to compensate for hardware delay.</li> <li>\ud83d\udd3d Mini Mode: Switches to transparent \"Always on top\" widget mode.</li> <li>\ud83c\udfa8 Theme: Changes appearance (Light, Dark, Red/Night).</li> </ul>"},{"location":"en/logiciel.html#3-first-start","title":"3. First Start","text":"<p>At launch, the application checks for the presence of the NTP service.</p> <p>\u26a0\ufe0f Absolute Prerequisite: NTP Service</p> <p>This software does NOT work with the standard Windows Time service (W32Time).</p> <p>To achieve millisecond precision (Stratum 1), you MUST install the official NTP service maintained by Meinberg.</p> <ol> <li> <p>Download the \"NTP for Windows\" installer from the official site: https://www.meinbergglobal.com/english/sw/ntp.htm</p> <p>\u26a0\ufe0f Warning: Installation must be performed in administrator mode (Right click &gt; Run as administrator) for the service to register correctly.</p> </li> <li> <p>During installation, keep default options.</p> </li> <li>Once installed, the \"Network Time Protocol Daemon\" service will be active on your machine.</li> </ol> <p>Why? W32Time is designed for domain synchronization (Kerberos) with a tolerance of 5 minutes. Meinberg NTP uses complex algorithms to discipline the clock with microsecond precision and handle hardware sources like our GPS.</p> <p>If the service is installed but stopped, the application will attempt to start it automatically.</p>"},{"location":"en/logiciel.html#4-first-configuration","title":"4. First Configuration","text":"<ol> <li> <p>Click on the Settings button (gear icon).</p> <p></p> Field Description Recommended Value Serial Port The virtual COM port of the RP2040 (see Device Manager). <code>COMx</code> Speed The serial communication speed of the GPS module. <code>9600</code> Server The Internet NTP pool used for calibration and fallback. <code>fr.pool.ntp.org</code> Find your NTP servers Opens <code>ntppool.org</code> to find servers in your region. Copy the server list corresponding to your country (without the \"server\" keyword) ntp.conf Path The full path to the NTP service configuration file. <code>C:\\Program Files (x86)\\NTP\\etc\\ntp.conf</code> Compensation The hardware delay to compensate. This value is adjusted automatically by the calibration assistant. <code>0.000</code> (Initially) Always visible Keeps the window in the foreground (Always on Top). - Opacity Adjusts window transparency. 100% </li> <li> <p>Click Save.</p> <ul> <li>The application will generate an <code>ntp.conf</code> file optimized for your hardware.</li> <li>It will restart the NTP service to apply changes.</li> </ul> </li> </ol>"},{"location":"en/logiciel.html#5-calibration","title":"5. Calibration","text":"<p>Compensation is the hardware transmission delay (USB cable, serial processing). It must be compensated to be perfectly on time. Click Calibration to launch the assistant.</p> <p>\u2139\ufe0f When to calibrate?</p> <p>This operation must be performed once for any new assembly (PC - USB Cable - GPS). The compensation is saved.</p> <p>It is preferable to perform calibration on a stable network like Fiber rather than on a mobile network (3G/4G/5G).</p> <p>The assistant compares your GPS with Internet time servers (Stratum 1/2) for a given period.</p> <p>Choose a calibration duration (between 1 min and 60 min). The longer the duration, the better the calibration precision.</p> <p>The graph displays in bold the median offset (in ms) calculated over the measurement. Thin lines correspond to the measured offset of each source.</p> <p>The assistant waits for the GPS to be stable (Reach = 377) and for at least one Internet source to be stable (Reach = 377) to start calculating the median.     </p>"},{"location":"en/logiciel.html#calibration-algorithm","title":"Calibration Algorithm","text":"<ol> <li>Isolation (Observation Mode):<ul> <li>The GPS driver is configured in <code>noselect</code> mode in NTP.</li> <li>It continues to send data for analysis, but no longer disciplines the local clock.</li> </ul> </li> <li>Absolute Reference:<ul> <li>The NTP service is forced to synchronize only with Internet servers (Stratum 2).</li> <li>The PC system clock therefore aligns with Internet UTC time.</li> </ul> </li> <li>Sampling:<ul> <li>The application continuously measures the deviation (<code>offset</code>) reported by the GPS driver relative to this synchronized system clock.</li> <li>A series of measurements is performed to smooth out network \"noise\" (Jitter).</li> </ul> </li> <li>Calculation and Application:<ul> <li>The algorithm extracts the median of deviations to eliminate outliers.</li> <li>It calculates the correction necessary to align the GPS with the Internet and updates the Compensation <code>time2</code> (fudge) parameter in <code>ntp.conf</code>.</li> <li>The <code>Compensation</code> value is saved and visible in settings.</li> </ul> </li> </ol>"},{"location":"en/logiciel.html#6-advanced-tools","title":"6. Advanced Tools","text":"<ul> <li> <p>NTP Sources (Peers): Displays details of configured time servers (command <code>ntpq -p</code>).</p> <p>This window allows diagnosing why NTP chooses or rejects a source.</p> <p>The source GPS_NMEA(x) is your GPS receiver. x corresponds to the COMx port used.</p> <p> </p> <p>Note: To close this window, double-click on it.</p> <p>Legend of symbols: *   <code>*</code> (Asterisk): The current synchronization source (System Peer). *   <code>+</code> (Plus): Good quality candidate source, ready to take over. *   <code>-</code> (Minus): Source discarded by the selection algorithm (Outlier). *   <code>x</code> (Cross): Rejected source (False ticker, too much deviation, or unreachable).</p> <p>Main columns: *   remote: Server or driver address (e.g., <code>127.127.20.x</code> for GPS). *   refid: The reference source of this server (e.g., <code>.GPS.</code>, <code>.PPS.</code>). *   st: Stratum (Distance from the atomic source). *   reach: Availability register (377 = 100% success on the last 8 attempts). *   offset: Time deviation in milliseconds. *   jitter: Signal stability in milliseconds.</p> </li> <li> <p>Signal Quality: Analyzes satellite power (SNR) and geometry (HDOP).</p> <ul> <li>Note: This function requires temporary stopping of NTP to access the serial port directly.</li> </ul> <p>This window allows diagnosing the quality of your antenna installation.</p> <p></p> <p>Detail of indicators:</p> <ul> <li> <p>SCORE: Signal Quality Index (0 to 100%).     It is a weighted global score calculated from the three parameters below.</p> <ul> <li>100%: Optimal reception.</li> <li>&lt; 50%: Degraded reception, risk of synchronization loss.</li> </ul> </li> <li> <p>SNR (Signal Noise Ratio): Average Signal/Noise Ratio (in dB).</p> <ul> <li>&gt; 30 dB (Green): Strong and clear signal.</li> <li>20 - 30 dB (Orange): Average signal.</li> <li>&lt; 20 dB (Red): Weak signal, risk of dropout.</li> </ul> </li> <li> <p>HDOP (Horizontal Dilution of Precision): Geometric precision.</p> <ul> <li>Indicates the dispersion of satellites in the sky. The lower the value, the better the precision.</li> <li>&lt; 2.0 (Green): Ideal.</li> <li>2.0 - 5.0 (Orange): Acceptable.</li> <li>&gt; 5.0 (Red): Bad (Obstructed sky, urban canyon).</li> </ul> </li> <li> <p>SATS: Number of satellites used.</p> <ul> <li>&gt; 8 (Green): Comfortable.</li> <li>4 - 8 (Orange): Vital minimum.</li> <li>&lt; 4 (Red): Insufficient for reliable triangulation.</li> </ul> </li> </ul> </li> <li> <p>Logs: Event history for troubleshooting.</p> </li> </ul>"},{"location":"en/logiciel.html#7-mini-mode-widget","title":"7. Mini Mode (Widget)","text":"<p>To monitor your time server without cluttering the screen: 1.  Click the Mini Mode button or double-click the display. 2.  The application becomes a small transparent window that stays in the foreground (\"Always on top\"). 3.  Double-click it to return to normal mode.</p> <pre><code>![Ma photo](../PrintScreen/Fenetre_mini.png)\n</code></pre>"},{"location":"en/materiel.html","title":"Hardware &amp; Assembly Guide","text":"<p>This guide details the necessary components and assembly steps to build your Stratum 0 GPS receiver.</p>"},{"location":"en/materiel.html#1-component-sourcing","title":"1. Component Sourcing","text":"<p>The project is designed to be accessible and inexpensive. Here is the list of recommended components:</p> Component Recommended Model Role Microcontroller Waveshare RP2040-Zero USB interface and signal processing. Chosen for its compact size and Arduino compatibility. GPS Module u-blox NEO-6M or NEO-8M Satellite reception. Often sold under the reference <code>GY-GPS6MV2</code> or <code>GY-NEO6MV2</code>. USB Cable USB Type-C (Data) Connection to the PC. Ensure it transmits data (not just charge)."},{"location":"en/materiel.html#2-inter-module-wiring","title":"2. Inter-module Wiring","text":"<p>The assembly connects the GPS module to the microcontroller via a serial link (UART). </p>"},{"location":"en/materiel.html#connection-diagram","title":"Connection Diagram","text":"GPS Pin RP2040-Zero Pin Description VCC 5V (or VBUS) GPS module power supply. GND GND Common ground (Electrical reference). TX GP1 (RX) Transmission of NMEA data from GPS to RP2040. RX GP0 (TX) Reception of configuration commands. PPS GP2 PPS Signal (Pulse per Second)."},{"location":"en/materiel.html#3-pps-signal-wiring","title":"3. PPS Signal Wiring","text":"<p>This is the most critical connection for the time precision of this project.</p> <p>Not all GPS modules have a PPS pin.</p> <p>This is the case for the NEO-6M (see photo). In this case, you must connect to the output of the circuit powering the LED. It is the orange wire.</p> <p>The NEO-8M has a pin called PPS.</p> <ul> <li>Destination: Pin GP2 of the RP2040-Zero.</li> </ul> <p></p> <p>Why is it indispensable? NMEA data (sent via TX/RX) provides date and time, but with variable latency (Jitter) of several hundred milliseconds due to serial processing.</p> <p>The PPS (Pulse Per Second) signal is an electrical pulse sent physically at the exact beginning of each atomic second. The RP2040 uses this signal to align data transmission to the PC with microsecond precision.</p>"},{"location":"en/materiel.html#visual-indicator-pps-led","title":"Visual Indicator (PPS LED)","text":"<p>Most GPS modules (u-blox NEO-6M/8M) have a small integrated LED connected to the PPS signal.</p> <ul> <li>Behavior: It remains off (or solid depending on the model) while the GPS searches for satellites. It starts flashing as soon as \"Fix\" is acquired (3D Fix).</li> <li>Signal characteristics: It is the rising edge (start of lighting) that marks the precise second. <p>Note: The electrical pulse lasts exactly 100 ms.</p> </li> </ul>"},{"location":"en/materiel.html#4-positioning-and-disturbances","title":"4. Positioning and Disturbances","text":"<p>GPS/GNSS signals are extremely weak radio waves (-125 dBm to -160 dBm). The physical environment of the assembly directly impacts reception quality (SNR).</p>"},{"location":"en/materiel.html#avoid-interferences","title":"Avoid interferences","text":"<p>Fast digital electronics (RP2040 processor, USB port, PC) generate RF \"noise\" that can jam the GPS antenna.</p> <ul> <li>Distance: Do not stick the GPS antenna directly on the RP2040. Leave at least 5 to 10 cm of cable between them.</li> <li>Enclosure: If using a metal case, the antenna must be outside.</li> </ul>"},{"location":"en/materiel.html#antenna-orientation","title":"Antenna Orientation","text":"<ul> <li>The ceramic antenna (flat square) must have a clear view of the sky.</li> <li>It works through plastic, glass, or wood, but not through metal or carbon fiber.</li> <li>For indoor use (near a window), precision will be lower (degraded Stratum 1) compared to an active outdoor antenna.</li> </ul>"},{"location":"en/materiel.html#5-firmware-installation-stratum-0","title":"5. Firmware Installation (Stratum 0)","text":"<p>Once the hardware is assembled, you must flash the RP2040 to act as a smart interface.</p> <ol> <li>Download the <code>Stratum0.uf2</code> file from the Releases section of the GitHub project.</li> <li>Unplug the RP2040 from the PC.</li> <li>Hold the BOOT button on the RP2040 and plug it into the PC.</li> <li>An <code>RPI-RP2</code> drive appears in the file explorer.</li> <li>Copy the <code>Stratum0.uf2</code> file to this drive.</li> <li>The RP2040 restarts automatically: your hardware is ready.</li> </ol>"},{"location":"en/materiel.html#diagnostic-led-rp2040-zero","title":"\ud83d\udca1 Diagnostic LED (RP2040-Zero)","text":"<p>The internal RGB LED indicates the status of the GPS: * Blue: No data received from GPS (check wiring). * Red: GPS data received, but no satellite fix yet. * Green: GPS Fix acquired, but PPS signal missing (&gt; 5s). * White Flash: PPS signal detected (LED turns off between flashes when PPS is active).</p> <p>You can verify that your GPS is emitting NMEA frames by analyzing the serial port using software like Putty.</p> <p></p>"},{"location":"en/materiel.html#6-firmware-operation-going-further","title":"6. Firmware Operation (Going further)","text":"<p>The RP2040 code doesn't just relay data. It transforms the consumer GPS module into a scientific reference clock.</p>"},{"location":"en/materiel.html#the-technical-challenge","title":"The Technical Challenge","text":"<p>A GPS module emits two pieces of information:</p> <ol> <li>The PPS signal: An ultra-precise electrical pulse at the beginning of the second.</li> <li>The NMEA frame: A text message (\"It is 12:00:00\") sent via the serial port.</li> </ol> <p>The problem is that the text message arrives after the pulse (about 100 to 500ms later). If the computer waits for the message to align with the next PPS, it will be one second late.</p>"},{"location":"en/materiel.html#the-software-solution","title":"The Software Solution","text":"<p>The firmware uses a \"Time Adder\" algorithm:</p> <ol> <li>It reads the NMEA frame as soon as it arrives.</li> <li>It adds 1 second to the received time (handling minute, hour, day, year rollovers).</li> <li>It stores this \"futuristic\" frame in memory.</li> <li>It waits for the next PPS signal.</li> <li>As soon as the PPS strikes, it immediately sends the modified frame via USB.</li> </ol> <p>Result: Windows receives the time \"12:00:01\" at the exact microsecond when second 12:00:01 begins.</p>"},{"location":"en/theorie.html","title":"NTP Theory &amp; Synchronization","text":"<p>Understanding the mechanisms that allow your computer to be precisely on time is essential to getting the most out of this project. This page popularizes the key concepts of the NTP protocol and explains why adding a GPS changes the game.</p>"},{"location":"en/theorie.html#1-what-is-ntp","title":"1. What is NTP?","text":"<p>NTP (Network Time Protocol) is one of the oldest protocols on the Internet. Its role is to synchronize computer clocks across a network with variable latency.</p> <p>It operates on a hierarchical model organized into Strata (Stratum):</p> <ul> <li>Stratum 0: The physical time source (Atomic Clock, GPS). It does not connect to the network.</li> <li>Stratum 1: A computer directly connected to a Stratum 0 source (via serial/USB cable). This is the \"Primary Time Server\". This is the role of your PC with this project.</li> <li>Stratum 2: A computer that requests time from a Stratum 1 server via the Internet.</li> <li>Stratum 3: A computer that requests time from a Stratum 2, and so on...</li> </ul> <p>The higher the stratum number, the more precision degrades due to transmission delays.</p>"},{"location":"en/theorie.html#2-why-is-gps-superior-to-the-internet","title":"2. Why is GPS superior to the Internet?","text":"<p>Most PCs synchronize over the Internet (Stratum 2 or 3). Although sufficient for daily life, this system suffers from major flaws for astronomy or science:</p>"},{"location":"en/theorie.html#a-variable-latency-jitter","title":"A. Variable Latency (Jitter)","text":"<p>On the Internet, data packets travel by different paths and pass through congested routers. The \"outbound\" travel time is never exactly the same as the \"return\" time. This unpredictable variation is called Jitter. *   Internet: Typical jitter of 10 to 100 ms. *   Local GPS: Near-zero jitter (&lt; 0.005 ms) because the link is direct (USB/Serial cable).</p>"},{"location":"en/theorie.html#b-asymmetry","title":"B. Asymmetry","text":"<p>NTP theoretically assumes that the Outbound travel time is equal to the Return travel time. However, on a consumer ADSL, 4G, or Fiber connection, download and upload speeds are different, creating a systematic calculation error (Offset) impossible to correct via software.</p>"},{"location":"en/theorie.html#c-availability","title":"C. Availability","text":"<p>Without Internet, your PC clock drifts quickly (several seconds per day). GPS works everywhere on Earth, without subscription and without network, guaranteeing total autonomy (\"Field\" mode).</p>"},{"location":"en/theorie.html#3-why-use-meinberg-ntp","title":"3. Why use Meinberg NTP?","text":"<p>Windows includes a default time service called W32Time. Why replace it?</p> <ul> <li>W32Time was designed for network authentication (Kerberos), which tolerates up to 5 minutes of error. It is not designed for high scientific precision. It often corrects time by brutal \"jumps\".</li> <li>Meinberg NTP is the Windows port of the official NTP daemon (the one used by NASA or CERN Linux servers).<ul> <li>It disciplines the clock gently (speeds up/slows down the frequency) without time jumps.</li> <li>It achieves microsecond-level precision.</li> <li>It offers advanced diagnostic tools (<code>ntpq</code>) that this software uses.</li> </ul> </li> </ul>"},{"location":"en/theorie.html#4-ntp-algorithms","title":"4. NTP Algorithms","text":"<p>NTP is not a simple \"time setting\". It is a complex servo system.</p>"},{"location":"en/theorie.html#the-intersection-algorithm-marzullo","title":"The Intersection Algorithm (Marzullo)","text":"<p>If you configure multiple sources (e.g., GPS + 3 Internet servers), NTP must guess who is telling the truth. It compares the time intervals of each source and rejects \"liars\" (False Tickers) that deviate too much from the consensus. This allows ignoring a faulty Internet server.</p>"},{"location":"en/theorie.html#the-discipline-loop-pllfll","title":"The Discipline Loop (PLL/FLL)","text":"<p>Once the best source is chosen, NTP does not just \"reset\" the time. It calculates the natural drift of your quartz (Drift). *   If your PC is 10ms late, NTP will slightly increase the clock frequency to catch up gradually. *   This guarantees a continuous and monotonic time scale (no backward steps possible), essential for data logging (Logs, Databases, Light Curves).</p>"},{"location":"en/theorie.html#5-glossary-of-common-terms","title":"5. Glossary of Common Terms","text":"<p>Here are the technical terms you will encounter in the application:</p> Term Definition Unit Good values Offset The time difference between your PC and the absolute reference. This is the error to correct. ms Close to 0 (e.g., +/- 2ms) Jitter Signal stability (latency variance). A low value indicates a reliable connection. ms &lt; 5 ms (GPS) Drift The natural drift of your PC's hardware clock (quartz inaccuracy). ppm Stable (e.g., 15.000 ppm) Reach Register (octal) indicating the success of the last 8 connection attempts. This is the health history. - 377 (100% success) Poll Interval between two source queries (power of 2). s 16s (Poll 4) to 1024s (Poll 10) PPS Pulse Per Second. Electrical signal sent by the GPS at each precise second start. This is the ultimate synchronization \"tick\". - -"}]}